{"ast":null,"code":"\"use strict\";\n\nexports.__esModule = !0, exports.default = exports.Select = void 0;\n\nvar _styledBase = _interopRequireDefault(require(\"@emotion/styled-base\")),\n    _react = _interopRequireWildcard(require(\"react\")),\n    _reactDom = _interopRequireDefault(require(\"react-dom\")),\n    _propTypes = _interopRequireDefault(require(\"prop-types\")),\n    _ClickOutside = _interopRequireDefault(require(\"./components/ClickOutside\")),\n    _Content = _interopRequireDefault(require(\"./components/Content\")),\n    _Dropdown = _interopRequireDefault(require(\"./components/Dropdown\")),\n    _Loading = _interopRequireDefault(require(\"./components/Loading\")),\n    _Clear = _interopRequireDefault(require(\"./components/Clear\")),\n    _Separator = _interopRequireDefault(require(\"./components/Separator\")),\n    _DropdownHandle = _interopRequireDefault(require(\"./components/DropdownHandle\")),\n    _util = require(\"./util\"),\n    _constants = require(\"./constants\");\n\nfunction _interopRequireWildcard(a) {\n  if (a && a.__esModule) return a;\n  var b = {};\n  if (null != a) for (var c in a) if (Object.prototype.hasOwnProperty.call(a, c)) {\n    var d = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(a, c) : {};\n    d.get || d.set ? Object.defineProperty(b, c, d) : b[c] = a[c];\n  }\n  return b.default = a, b;\n}\n\nfunction _interopRequireDefault(a) {\n  return a && a.__esModule ? a : {\n    default: a\n  };\n}\n\nfunction _assertThisInitialized(a) {\n  if (void 0 === a) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return a;\n}\n\nfunction _inheritsLoose(a, b) {\n  a.prototype = Object.create(b.prototype), a.prototype.constructor = a, a.__proto__ = b;\n}\n\nfunction _defineProperty(a, b, c) {\n  return b in a ? Object.defineProperty(a, b, {\n    value: c,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : a[b] = c, a;\n}\n\nvar Select =\n/*#__PURE__*/\nfunction (a) {\n  function b(b) {\n    var c;\n    return c = a.call(this, b) || this, _defineProperty(_assertThisInitialized(c), \"onDropdownClose\", function () {\n      c.setState({\n        cursor: null\n      }), c.props.onDropdownClose();\n    }), _defineProperty(_assertThisInitialized(c), \"onScroll\", function () {\n      c.props.closeOnScroll && c.dropDown(\"close\"), c.updateSelectBounds();\n    }), _defineProperty(_assertThisInitialized(c), \"updateSelectBounds\", function () {\n      return c.select.current && c.setState({\n        selectBounds: c.select.current.getBoundingClientRect()\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"getSelectBounds\", function () {\n      return c.state.selectBounds;\n    }), _defineProperty(_assertThisInitialized(c), \"dropDown\", function (a, b) {\n      void 0 === a && (a = \"toggle\");\n      var d = b && b.target || b && b.srcElement;\n      return c.props.portal && !c.props.closeOnScroll && !c.props.closeOnSelect && b && d && d.offsetParent && d.offsetParent.classList.contains(\"react-dropdown-select-dropdown\") ? void 0 : c.props.keepOpen ? c.setState({\n        dropdown: !0\n      }) : \"close\" === a && c.state.dropdown ? (c.select.current.blur(), c.setState({\n        dropdown: !1,\n        search: c.props.clearOnBlur ? \"\" : c.state.search\n      })) : \"open\" !== a || c.state.dropdown ? \"toggle\" === a && (c.select.current.focus(), c.setState({\n        dropdown: !c.state.dropdown\n      })) : c.setState({\n        dropdown: !0\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"getSelectRef\", function () {\n      return c.select.current;\n    }), _defineProperty(_assertThisInitialized(c), \"addItem\", function (a) {\n      if (c.props.multi) {\n        if ((0, _util.valueExistInSelected)((0, _util.getByPath)(a, c.props.valueField), c.state.values, c.props)) return c.removeItem(null, a, !1);\n        c.setState({\n          values: [].concat(c.state.values, [a])\n        });\n      } else c.setState({\n        values: [a],\n        dropdown: !1\n      });\n\n      return c.props.clearOnSelect && c.setState({\n        search: \"\"\n      }), !0;\n    }), _defineProperty(_assertThisInitialized(c), \"removeItem\", function (a, b, d) {\n      void 0 === d && (d = !1), a && d && (a.preventDefault(), a.stopPropagation(), c.dropDown(\"close\")), c.setState({\n        values: c.state.values.filter(function (a) {\n          return (0, _util.getByPath)(a, c.props.valueField) !== (0, _util.getByPath)(b, c.props.valueField);\n        })\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"setSearch\", function (a) {\n      c.setState({\n        cursor: null\n      }), c.setState({\n        search: a.target.value\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"getInputSize\", function () {\n      return c.state.search ? c.state.search.length : 0 < c.state.values.length ? c.props.addPlaceholder.length : c.props.placeholder.length;\n    }), _defineProperty(_assertThisInitialized(c), \"toggleSelectAll\", function () {\n      return c.setState({\n        values: 0 === c.state.values.length ? c.selectAll() : c.clearAll()\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"clearAll\", function () {\n      c.props.onClearAll(), c.setState({\n        values: []\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"selectAll\", function () {\n      return c.props.onSelectAll(), c.setState({\n        values: c.props.options.filter(function (a) {\n          return !a.disabled;\n        })\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"isSelected\", function (a) {\n      return !!c.state.values.find(function (b) {\n        return (0, _util.getByPath)(b, c.props.valueField) === (0, _util.getByPath)(a, c.props.valueField);\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"areAllSelected\", function () {\n      return c.state.values.length === c.props.options.filter(function (a) {\n        return !a.disabled;\n      }).length;\n    }), _defineProperty(_assertThisInitialized(c), \"safeString\", function (a) {\n      return a.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n    }), _defineProperty(_assertThisInitialized(c), \"sortBy\", function () {\n      var a = c.props,\n          d = a.sortBy,\n          e = a.options;\n      return d ? (e.sort(function (c, a) {\n        return (0, _util.getProp)(c, d) < (0, _util.getProp)(a, d) ? -1 : (0, _util.getProp)(c, d) > (0, _util.getProp)(a, d) ? 1 : 0;\n      }), e) : e;\n    }), _defineProperty(_assertThisInitialized(c), \"searchFn\", function (a) {\n      var b = a.state,\n          d = a.methods,\n          e = new RegExp(d.safeString(b.search), \"i\");\n      return d.sortBy().filter(function (a) {\n        return e.test((0, _util.getByPath)(a, c.props.searchBy) || (0, _util.getByPath)(a, c.props.valueField));\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"searchResults\", function () {\n      var a = {\n        state: c.state,\n        props: c.props,\n        methods: c.methods\n      };\n      return c.props.searchFn(a) || c.searchFn(a);\n    }), _defineProperty(_assertThisInitialized(c), \"activeCursorItem\", function (a) {\n      return c.setState({\n        activeCursorItem: a\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"handleKeyDown\", function (a) {\n      var b = {\n        event: a,\n        state: c.state,\n        props: c.props,\n        methods: c.methods,\n        setState: c.setState.bind(_assertThisInitialized(c))\n      };\n      return c.props.handleKeyDownFn(b) || c.handleKeyDownFn(b);\n    }), _defineProperty(_assertThisInitialized(c), \"handleKeyDownFn\", function (a) {\n      var b = a.event,\n          d = a.state,\n          e = a.props,\n          f = a.methods,\n          g = a.setState,\n          h = d.cursor;\n      if (\"ArrowDown\" === b.key && null === h) return g({\n        cursor: 0\n      });\n\n      if ((\"ArrowUp\" === b.key || \"ArrowDown\" === b.key) && b.preventDefault(), \"Escape\" === b.key && c.dropDown(\"close\"), \"Enter\" === b.key) {\n        var i = f.searchResults()[h];\n\n        if (i && !i.disabled) {\n          if (e.create && (0, _util.valueExistInSelected)(d.search, d.values, e)) return null;\n          f.addItem(i);\n        }\n      }\n\n      return (\"ArrowUp\" === b.key && 0 < h && g(function (a) {\n        return {\n          cursor: a.cursor - 1\n        };\n      }), \"ArrowUp\" === b.key && 0 === h && g({\n        cursor: f.searchResults().length\n      }), \"ArrowDown\" === b.key && g(function (a) {\n        return {\n          cursor: a.cursor + 1\n        };\n      }), \"ArrowDown\" === b.key && f.searchResults().length === h) ? g({\n        cursor: 0\n      }) : void 0;\n    }), _defineProperty(_assertThisInitialized(c), \"renderDropdown\", function () {\n      return c.props.portal ? _reactDom.default.createPortal(_react.default.createElement(_Dropdown.default, {\n        props: c.props,\n        state: c.state,\n        methods: c.methods\n      }), c.dropdownRoot) : _react.default.createElement(_Dropdown.default, {\n        props: c.props,\n        state: c.state,\n        methods: c.methods\n      });\n    }), _defineProperty(_assertThisInitialized(c), \"createNew\", function (a) {\n      var b,\n          d = (b = {}, b[c.props.labelField] = a, b[c.props.valueField] = a, b);\n      c.addItem(d), c.props.onCreateNew(d), c.setState({\n        search: \"\"\n      });\n    }), c.state = {\n      dropdown: !1,\n      values: b.values,\n      search: \"\",\n      selectBounds: {},\n      cursor: null\n    }, c.methods = {\n      removeItem: c.removeItem,\n      dropDown: c.dropDown,\n      addItem: c.addItem,\n      setSearch: c.setSearch,\n      getInputSize: c.getInputSize,\n      toggleSelectAll: c.toggleSelectAll,\n      clearAll: c.clearAll,\n      selectAll: c.selectAll,\n      searchResults: c.searchResults,\n      getSelectRef: c.getSelectRef,\n      isSelected: c.isSelected,\n      getSelectBounds: c.getSelectBounds,\n      areAllSelected: c.areAllSelected,\n      handleKeyDown: c.handleKeyDown,\n      activeCursorItem: c.activeCursorItem,\n      createNew: c.createNew,\n      sortBy: c.sortBy,\n      safeString: c.safeString\n    }, c.select = _react.default.createRef(), c.dropdownRoot = \"undefined\" != typeof document && document.createElement(\"div\"), c;\n  }\n\n  _inheritsLoose(b, a);\n\n  var c = b.prototype;\n  return c.componentDidMount = function componentDidMount() {\n    this.props.portal && this.props.portal.appendChild(this.dropdownRoot), window.addEventListener(\"resize\", (0, _util.debounce)(this.updateSelectBounds)), window.addEventListener(\"scroll\", (0, _util.debounce)(this.onScroll)), this.props.onChange(this.state.values), this.dropDown(\"close\"), this.select && this.updateSelectBounds();\n  }, c.componentDidUpdate = function componentDidUpdate(a, b) {\n    !(0, _util.isEqual)(a.values, this.props.values) && (0, _util.isEqual)(a.values, b.values) && (this.props.onChange(this.state.values), this.setState({\n      values: this.props.values\n    }), this.updateSelectBounds()), b.values !== this.state.values && (this.props.onChange(this.state.values), this.updateSelectBounds()), b.search !== this.state.search && this.updateSelectBounds(), b.values !== this.state.values && this.props.closeOnSelect && this.dropDown(\"close\"), a.multi !== this.props.multi && this.updateSelectBounds(), b.dropdown && b.dropdown !== this.state.dropdown && this.onDropdownClose(), b.dropdown || b.dropdown === this.state.dropdown || this.props.onDropdownOpen();\n  }, c.componentWillUnmount = function componentWillUnmount() {\n    this.props.portal && this.props.portal.removeChild(this.dropdownRoot), window.removeEventListener(\"resize\", (0, _util.debounce)(this.updateSelectBounds, this.props.debounceDelay)), window.removeEventListener(\"scroll\", (0, _util.debounce)(this.onScroll, this.props.debounceDelay));\n  }, c.render = function render() {\n    var a = this;\n    return _react.default.createElement(_ClickOutside.default, {\n      onClickOutside: function onClickOutside(b) {\n        return a.dropDown(\"close\", b);\n      }\n    }, _react.default.createElement(ReactDropdownSelect, {\n      onKeyDown: this.handleKeyDown,\n      onClick: function onClick(b) {\n        return a.dropDown(\"open\", b);\n      },\n      tabIndex: \"0\",\n      direction: this.props.direction,\n      style: this.props.style,\n      ref: this.select,\n      disabled: this.props.disabled,\n      className: _constants.LIB_NAME + \" \" + this.props.className,\n      color: this.props.color\n    }, _react.default.createElement(_Content.default, {\n      props: this.props,\n      state: this.state,\n      methods: this.methods\n    }), this.props.name && _react.default.createElement(\"input\", {\n      name: this.props.name,\n      type: \"hidden\",\n      value: this.props.values\n    }), this.props.loading && _react.default.createElement(_Loading.default, {\n      props: this.props\n    }), this.props.clearable && _react.default.createElement(_Clear.default, {\n      props: this.props,\n      state: this.state,\n      methods: this.methods\n    }), this.props.separator && _react.default.createElement(_Separator.default, {\n      props: this.props,\n      state: this.state,\n      methods: this.methods\n    }), this.props.dropdownHandle && _react.default.createElement(_DropdownHandle.default, {\n      onClick: function onClick() {\n        return a.select.current.focus();\n      },\n      props: this.props,\n      state: this.state,\n      methods: this.methods\n    }), this.state.dropdown && this.renderDropdown()));\n  }, b;\n}(_react.Component);\n\nexports.Select = Select, Select.defaultProps = {\n  addPlaceholder: \"\",\n  placeholder: \"Select...\",\n  values: [],\n  options: [],\n  multi: !1,\n  disabled: !1,\n  searchBy: \"label\",\n  sortBy: null,\n  clearable: !1,\n  searchable: !0,\n  dropdownHandle: !0,\n  separator: !1,\n  keepOpen: void 0,\n  noDataLabel: \"No data\",\n  createNewLabel: \"add {search}\",\n  disabledLabel: \"disabled\",\n  dropdownGap: 5,\n  closeOnScroll: !1,\n  debounceDelay: 0,\n  labelField: \"label\",\n  valueField: \"value\",\n  color: \"#0074D9\",\n  keepSelectedInList: !0,\n  closeOnSelect: !1,\n  clearOnBlur: !0,\n  clearOnSelect: !0,\n  dropdownPosition: \"bottom\",\n  dropdownHeight: \"300px\",\n  autoFocus: !1,\n  portal: null,\n  create: !1,\n  direction: \"ltr\",\n  name: null,\n  onChange: function onChange() {},\n  onDropdownOpen: function onDropdownOpen() {},\n  onDropdownClose: function onDropdownClose() {},\n  onClearAll: function onClearAll() {},\n  onSelectAll: function onSelectAll() {},\n  onCreateNew: function onCreateNew() {},\n  searchFn: function searchFn() {},\n  handleKeyDownFn: function handleKeyDownFn() {}\n};\nvar ReactDropdownSelect = (0, _styledBase.default)(\"div\", {\n  target: \"e1gzf2xs0\",\n  label: \"ReactDropdownSelect\"\n})(\"position:relative;display:flex;border:1px solid #ccc;width:100%;border-radius:2px;padding:2px 5px;flex-direction:row;direction:\", function (a) {\n  var b = a.direction;\n  return b;\n}, \";align-items:center;min-height:36px;\", function (a) {\n  var b = a.disabled;\n  return b ? \"cursor: not-allowed;pointer-events: none;opacity: 0.3;\" : \"pointer-events: all;\";\n}, \":hover,:focus-within{border-color:\", function (a) {\n  var b = a.color;\n  return b;\n}, \";}:focus,:focus-within{outline:0;box-shadow:0 0 0 3px \", function (a) {\n  var b = a.color;\n  return (0, _util.hexToRGBA)(b, .2);\n}, \";}\" + (\"production\" === process.env.NODE_ENV ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFvZ0JzQyIsImZpbGUiOiIuLi9zcmMvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdAZW1vdGlvbi9zdHlsZWQnO1xuaW1wb3J0IENsaWNrT3V0c2lkZSBmcm9tICcuL2NvbXBvbmVudHMvQ2xpY2tPdXRzaWRlJztcblxuaW1wb3J0IENvbnRlbnQgZnJvbSAnLi9jb21wb25lbnRzL0NvbnRlbnQnO1xuaW1wb3J0IERyb3Bkb3duIGZyb20gJy4vY29tcG9uZW50cy9Ecm9wZG93bic7XG5pbXBvcnQgTG9hZGluZyBmcm9tICcuL2NvbXBvbmVudHMvTG9hZGluZyc7XG5pbXBvcnQgQ2xlYXIgZnJvbSAnLi9jb21wb25lbnRzL0NsZWFyJztcbmltcG9ydCBTZXBhcmF0b3IgZnJvbSAnLi9jb21wb25lbnRzL1NlcGFyYXRvcic7XG5pbXBvcnQgRHJvcGRvd25IYW5kbGUgZnJvbSAnLi9jb21wb25lbnRzL0Ryb3Bkb3duSGFuZGxlJztcblxuaW1wb3J0IHsgZGVib3VuY2UsIGhleFRvUkdCQSwgaXNFcXVhbCwgZ2V0QnlQYXRoLCBnZXRQcm9wLCB2YWx1ZUV4aXN0SW5TZWxlY3RlZCB9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQgeyBMSUJfTkFNRSB9IGZyb20gJy4vY29uc3RhbnRzJztcblxuZXhwb3J0IGNsYXNzIFNlbGVjdCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgb25Ecm9wZG93bkNsb3NlOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBvbkRyb3Bkb3duT3BlbjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25DbGVhckFsbDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb25TZWxlY3RBbGw6IFByb3BUeXBlcy5mdW5jLFxuICAgIHZhbHVlczogUHJvcFR5cGVzLmFycmF5LFxuICAgIG9wdGlvbnM6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkLFxuICAgIGtlZXBPcGVuOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBkcm9wZG93bkdhcDogUHJvcFR5cGVzLm51bWJlcixcbiAgICBtdWx0aTogUHJvcFR5cGVzLmJvb2wsXG4gICAgcGxhY2Vob2xkZXI6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgYWRkUGxhY2Vob2xkZXI6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgZGlzYWJsZWQ6IFByb3BUeXBlcy5ib29sLFxuICAgIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBsb2FkaW5nOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBjbGVhcmFibGU6IFByb3BUeXBlcy5ib29sLFxuICAgIHNlYXJjaGFibGU6IFByb3BUeXBlcy5ib29sLFxuICAgIHNlcGFyYXRvcjogUHJvcFR5cGVzLmJvb2wsXG4gICAgZHJvcGRvd25IYW5kbGU6IFByb3BUeXBlcy5ib29sLFxuICAgIHNlYXJjaEJ5OiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHNvcnRCeTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBjbG9zZU9uU2Nyb2xsOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBvcGVuT25Ub3A6IFByb3BUeXBlcy5ib29sLFxuICAgIHN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIGNvbnRlbnRSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZHJvcGRvd25SZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgaXRlbVJlbmRlcmVyOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBub0RhdGFSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgb3B0aW9uUmVuZGVyZXI6IFByb3BUeXBlcy5mdW5jLFxuICAgIGlucHV0UmVuZGVyZXI6IFByb3BUeXBlcy5mdW5jLFxuICAgIGxvYWRpbmdSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgY2xlYXJSZW5kZXJlcjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgc2VwYXJhdG9yUmVuZGVyZXI6IFByb3BUeXBlcy5mdW5jLFxuICAgIGRyb3Bkb3duSGFuZGxlUmVuZGVyZXI6IFByb3BUeXBlcy5mdW5jLFxuICAgIGRpcmVjdGlvbjogUHJvcFR5cGVzLnN0cmluZ1xuICB9O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGRyb3Bkb3duOiBmYWxzZSxcbiAgICAgIHZhbHVlczogcHJvcHMudmFsdWVzLFxuICAgICAgc2VhcmNoOiAnJyxcbiAgICAgIHNlbGVjdEJvdW5kczoge30sXG4gICAgICBjdXJzb3I6IG51bGxcbiAgICB9O1xuXG4gICAgdGhpcy5tZXRob2RzID0ge1xuICAgICAgcmVtb3ZlSXRlbTogdGhpcy5yZW1vdmVJdGVtLFxuICAgICAgZHJvcERvd246IHRoaXMuZHJvcERvd24sXG4gICAgICBhZGRJdGVtOiB0aGlzLmFkZEl0ZW0sXG4gICAgICBzZXRTZWFyY2g6IHRoaXMuc2V0U2VhcmNoLFxuICAgICAgZ2V0SW5wdXRTaXplOiB0aGlzLmdldElucHV0U2l6ZSxcbiAgICAgIHRvZ2dsZVNlbGVjdEFsbDogdGhpcy50b2dnbGVTZWxlY3RBbGwsXG4gICAgICBjbGVhckFsbDogdGhpcy5jbGVhckFsbCxcbiAgICAgIHNlbGVjdEFsbDogdGhpcy5zZWxlY3RBbGwsXG4gICAgICBzZWFyY2hSZXN1bHRzOiB0aGlzLnNlYXJjaFJlc3VsdHMsXG4gICAgICBnZXRTZWxlY3RSZWY6IHRoaXMuZ2V0U2VsZWN0UmVmLFxuICAgICAgaXNTZWxlY3RlZDogdGhpcy5pc1NlbGVjdGVkLFxuICAgICAgZ2V0U2VsZWN0Qm91bmRzOiB0aGlzLmdldFNlbGVjdEJvdW5kcyxcbiAgICAgIGFyZUFsbFNlbGVjdGVkOiB0aGlzLmFyZUFsbFNlbGVjdGVkLFxuICAgICAgaGFuZGxlS2V5RG93bjogdGhpcy5oYW5kbGVLZXlEb3duLFxuICAgICAgYWN0aXZlQ3Vyc29ySXRlbTogdGhpcy5hY3RpdmVDdXJzb3JJdGVtLFxuICAgICAgY3JlYXRlTmV3OiB0aGlzLmNyZWF0ZU5ldyxcbiAgICAgIHNvcnRCeTogdGhpcy5zb3J0QnksXG4gICAgICBzYWZlU3RyaW5nOiB0aGlzLnNhZmVTdHJpbmdcbiAgICB9O1xuXG4gICAgdGhpcy5zZWxlY3QgPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgICB0aGlzLmRyb3Bkb3duUm9vdCA9IHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLnByb3BzLnBvcnRhbCAmJiB0aGlzLnByb3BzLnBvcnRhbC5hcHBlbmRDaGlsZCh0aGlzLmRyb3Bkb3duUm9vdCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGRlYm91bmNlKHRoaXMudXBkYXRlU2VsZWN0Qm91bmRzKSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGRlYm91bmNlKHRoaXMub25TY3JvbGwpKTtcblxuICAgIHRoaXMucHJvcHMub25DaGFuZ2UodGhpcy5zdGF0ZS52YWx1ZXMpO1xuXG4gICAgdGhpcy5kcm9wRG93bignY2xvc2UnKTtcblxuICAgIGlmICh0aGlzLnNlbGVjdCkge1xuICAgICAgdGhpcy51cGRhdGVTZWxlY3RCb3VuZHMoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICBpZiAoXG4gICAgICAhaXNFcXVhbChwcmV2UHJvcHMudmFsdWVzLCB0aGlzLnByb3BzLnZhbHVlcykgJiZcbiAgICAgIGlzRXF1YWwocHJldlByb3BzLnZhbHVlcywgcHJldlN0YXRlLnZhbHVlcylcbiAgICApIHtcbiAgICAgIHRoaXMucHJvcHMub25DaGFuZ2UodGhpcy5zdGF0ZS52YWx1ZXMpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIHZhbHVlczogdGhpcy5wcm9wcy52YWx1ZXNcbiAgICAgIH0pO1xuICAgICAgdGhpcy51cGRhdGVTZWxlY3RCb3VuZHMoKTtcbiAgICB9XG5cbiAgICBpZiAocHJldlN0YXRlLnZhbHVlcyAhPT0gdGhpcy5zdGF0ZS52YWx1ZXMpIHtcbiAgICAgIHRoaXMucHJvcHMub25DaGFuZ2UodGhpcy5zdGF0ZS52YWx1ZXMpO1xuICAgICAgdGhpcy51cGRhdGVTZWxlY3RCb3VuZHMoKTtcbiAgICB9XG5cbiAgICBpZiAocHJldlN0YXRlLnNlYXJjaCAhPT0gdGhpcy5zdGF0ZS5zZWFyY2gpIHtcbiAgICAgIHRoaXMudXBkYXRlU2VsZWN0Qm91bmRzKCk7XG4gICAgfVxuXG4gICAgaWYgKHByZXZTdGF0ZS52YWx1ZXMgIT09IHRoaXMuc3RhdGUudmFsdWVzICYmIHRoaXMucHJvcHMuY2xvc2VPblNlbGVjdCkge1xuICAgICAgdGhpcy5kcm9wRG93bignY2xvc2UnKTtcbiAgICB9XG5cbiAgICBpZiAocHJldlByb3BzLm11bHRpICE9PSB0aGlzLnByb3BzLm11bHRpKSB7XG4gICAgICB0aGlzLnVwZGF0ZVNlbGVjdEJvdW5kcygpO1xuICAgIH1cblxuICAgIGlmIChwcmV2U3RhdGUuZHJvcGRvd24gJiYgcHJldlN0YXRlLmRyb3Bkb3duICE9PSB0aGlzLnN0YXRlLmRyb3Bkb3duKSB7XG4gICAgICB0aGlzLm9uRHJvcGRvd25DbG9zZSgpO1xuICAgIH1cblxuICAgIGlmICghcHJldlN0YXRlLmRyb3Bkb3duICYmIHByZXZTdGF0ZS5kcm9wZG93biAhPT0gdGhpcy5zdGF0ZS5kcm9wZG93bikge1xuICAgICAgdGhpcy5wcm9wcy5vbkRyb3Bkb3duT3BlbigpO1xuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHRoaXMucHJvcHMucG9ydGFsICYmIHRoaXMucHJvcHMucG9ydGFsLnJlbW92ZUNoaWxkKHRoaXMuZHJvcGRvd25Sb290KTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICdyZXNpemUnLFxuICAgICAgZGVib3VuY2UodGhpcy51cGRhdGVTZWxlY3RCb3VuZHMsIHRoaXMucHJvcHMuZGVib3VuY2VEZWxheSlcbiAgICApO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBkZWJvdW5jZSh0aGlzLm9uU2Nyb2xsLCB0aGlzLnByb3BzLmRlYm91bmNlRGVsYXkpKTtcbiAgfVxuXG4gIG9uRHJvcGRvd25DbG9zZSA9ICgpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHsgY3Vyc29yOiBudWxsIH0pO1xuICAgIHRoaXMucHJvcHMub25Ecm9wZG93bkNsb3NlKCk7XG4gIH07XG5cbiAgb25TY3JvbGwgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMucHJvcHMuY2xvc2VPblNjcm9sbCkge1xuICAgICAgdGhpcy5kcm9wRG93bignY2xvc2UnKTtcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZVNlbGVjdEJvdW5kcygpO1xuICB9O1xuXG4gIHVwZGF0ZVNlbGVjdEJvdW5kcyA9ICgpID0+XG4gICAgdGhpcy5zZWxlY3QuY3VycmVudCAmJlxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2VsZWN0Qm91bmRzOiB0aGlzLnNlbGVjdC5jdXJyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgfSk7XG5cbiAgZ2V0U2VsZWN0Qm91bmRzID0gKCkgPT4gdGhpcy5zdGF0ZS5zZWxlY3RCb3VuZHM7XG5cbiAgZHJvcERvd24gPSAoYWN0aW9uID0gJ3RvZ2dsZScsIGV2ZW50KSA9PiB7XG4gICAgY29uc3QgdGFyZ2V0ID0gKGV2ZW50ICYmIGV2ZW50LnRhcmdldCkgfHwgKGV2ZW50ICYmIGV2ZW50LnNyY0VsZW1lbnQpO1xuXG4gICAgaWYgKFxuICAgICAgdGhpcy5wcm9wcy5wb3J0YWwgJiZcbiAgICAgICF0aGlzLnByb3BzLmNsb3NlT25TY3JvbGwgJiZcbiAgICAgICF0aGlzLnByb3BzLmNsb3NlT25TZWxlY3QgJiZcbiAgICAgIGV2ZW50ICYmXG4gICAgICB0YXJnZXQgJiZcbiAgICAgIHRhcmdldC5vZmZzZXRQYXJlbnQgJiZcbiAgICAgIHRhcmdldC5vZmZzZXRQYXJlbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdyZWFjdC1kcm9wZG93bi1zZWxlY3QtZHJvcGRvd24nKVxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnByb3BzLmtlZXBPcGVuKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZXRTdGF0ZSh7IGRyb3Bkb3duOiB0cnVlIH0pO1xuICAgIH1cblxuICAgIGlmIChhY3Rpb24gPT09ICdjbG9zZScgJiYgdGhpcy5zdGF0ZS5kcm9wZG93bikge1xuICAgICAgdGhpcy5zZWxlY3QuY3VycmVudC5ibHVyKCk7XG5cbiAgICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZHJvcGRvd246IGZhbHNlLFxuICAgICAgICBzZWFyY2g6IHRoaXMucHJvcHMuY2xlYXJPbkJsdXIgPyAnJyA6IHRoaXMuc3RhdGUuc2VhcmNoXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoYWN0aW9uID09PSAnb3BlbicgJiYgIXRoaXMuc3RhdGUuZHJvcGRvd24pIHtcbiAgICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHsgZHJvcGRvd246IHRydWUgfSk7XG4gICAgfVxuXG4gICAgaWYgKGFjdGlvbiA9PT0gJ3RvZ2dsZScpIHtcbiAgICAgIHRoaXMuc2VsZWN0LmN1cnJlbnQuZm9jdXMoKTtcbiAgICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHsgZHJvcGRvd246ICF0aGlzLnN0YXRlLmRyb3Bkb3duIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBnZXRTZWxlY3RSZWYgPSAoKSA9PiB0aGlzLnNlbGVjdC5jdXJyZW50O1xuXG4gIGFkZEl0ZW0gPSAoaXRlbSkgPT4ge1xuICAgIGlmICh0aGlzLnByb3BzLm11bHRpKSB7XG4gICAgICBpZiAoXG4gICAgICAgIHZhbHVlRXhpc3RJblNlbGVjdGVkKGdldEJ5UGF0aChpdGVtLCB0aGlzLnByb3BzLnZhbHVlRmllbGQpLCB0aGlzLnN0YXRlLnZhbHVlcywgdGhpcy5wcm9wcylcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVJdGVtKG51bGwsIGl0ZW0sIGZhbHNlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIHZhbHVlczogWy4uLnRoaXMuc3RhdGUudmFsdWVzLCBpdGVtXVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICB2YWx1ZXM6IFtpdGVtXSxcbiAgICAgICAgZHJvcGRvd246IGZhbHNlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnByb3BzLmNsZWFyT25TZWxlY3QgJiYgdGhpcy5zZXRTdGF0ZSh7IHNlYXJjaDogJycgfSk7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICByZW1vdmVJdGVtID0gKGV2ZW50LCBpdGVtLCBjbG9zZSA9IGZhbHNlKSA9PiB7XG4gICAgaWYgKGV2ZW50ICYmIGNsb3NlKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLmRyb3BEb3duKCdjbG9zZScpO1xuICAgIH1cblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdmFsdWVzOiB0aGlzLnN0YXRlLnZhbHVlcy5maWx0ZXIoXG4gICAgICAgICh2YWx1ZXMpID0+XG4gICAgICAgICAgZ2V0QnlQYXRoKHZhbHVlcywgdGhpcy5wcm9wcy52YWx1ZUZpZWxkKSAhPT0gZ2V0QnlQYXRoKGl0ZW0sIHRoaXMucHJvcHMudmFsdWVGaWVsZClcbiAgICAgIClcbiAgICB9KTtcbiAgfTtcblxuICBzZXRTZWFyY2ggPSAoZXZlbnQpID0+IHtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGN1cnNvcjogbnVsbFxuICAgIH0pO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBzZWFyY2g6IGV2ZW50LnRhcmdldC52YWx1ZVxuICAgIH0pO1xuICB9O1xuXG4gIGdldElucHV0U2l6ZSA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5zdGF0ZS5zZWFyY2gpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0YXRlLnNlYXJjaC5sZW5ndGg7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3RhdGUudmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB0aGlzLnByb3BzLmFkZFBsYWNlaG9sZGVyLmxlbmd0aDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5wbGFjZWhvbGRlci5sZW5ndGg7XG4gIH07XG5cbiAgdG9nZ2xlU2VsZWN0QWxsID0gKCkgPT4ge1xuICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHtcbiAgICAgIHZhbHVlczogdGhpcy5zdGF0ZS52YWx1ZXMubGVuZ3RoID09PSAwID8gdGhpcy5zZWxlY3RBbGwoKSA6IHRoaXMuY2xlYXJBbGwoKVxuICAgIH0pO1xuICB9O1xuXG4gIGNsZWFyQWxsID0gKCkgPT4ge1xuICAgIHRoaXMucHJvcHMub25DbGVhckFsbCgpO1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdmFsdWVzOiBbXVxuICAgIH0pO1xuICB9O1xuXG4gIHNlbGVjdEFsbCA9ICgpID0+IHtcbiAgICB0aGlzLnByb3BzLm9uU2VsZWN0QWxsKCk7XG4gICAgcmV0dXJuIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdmFsdWVzOiB0aGlzLnByb3BzLm9wdGlvbnMuZmlsdGVyKChvcHRpb24pID0+ICFvcHRpb24uZGlzYWJsZWQpXG4gICAgfSk7XG4gIH07XG5cbiAgaXNTZWxlY3RlZCA9IChvcHRpb24pID0+XG4gICAgISF0aGlzLnN0YXRlLnZhbHVlcy5maW5kKFxuICAgICAgKHZhbHVlKSA9PlxuICAgICAgICBnZXRCeVBhdGgodmFsdWUsIHRoaXMucHJvcHMudmFsdWVGaWVsZCkgPT09IGdldEJ5UGF0aChvcHRpb24sIHRoaXMucHJvcHMudmFsdWVGaWVsZClcbiAgICApO1xuXG4gIGFyZUFsbFNlbGVjdGVkID0gKCkgPT5cbiAgICB0aGlzLnN0YXRlLnZhbHVlcy5sZW5ndGggPT09IHRoaXMucHJvcHMub3B0aW9ucy5maWx0ZXIoKG9wdGlvbikgPT4gIW9wdGlvbi5kaXNhYmxlZCkubGVuZ3RoO1xuXG4gIHNhZmVTdHJpbmcgPSAoc3RyaW5nKSA9PiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTtcblxuICBzb3J0QnkgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBzb3J0QnksIG9wdGlvbnMgfSA9IHRoaXMucHJvcHM7XG5cbiAgICBpZiAoIXNvcnRCeSkge1xuICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuXG4gICAgb3B0aW9ucy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBpZiAoZ2V0UHJvcChhLCBzb3J0QnkpIDwgZ2V0UHJvcChiLCBzb3J0QnkpKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH0gZWxzZSBpZiAoZ2V0UHJvcChhLCBzb3J0QnkpID4gZ2V0UHJvcChiLCBzb3J0QnkpKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gb3B0aW9ucztcbiAgfTtcblxuICBzZWFyY2hGbiA9ICh7IHN0YXRlLCBtZXRob2RzIH0pID0+IHtcbiAgICBjb25zdCByZWdleHAgPSBuZXcgUmVnRXhwKG1ldGhvZHMuc2FmZVN0cmluZyhzdGF0ZS5zZWFyY2gpLCAnaScpO1xuXG4gICAgcmV0dXJuIG1ldGhvZHNcbiAgICAgIC5zb3J0QnkoKVxuICAgICAgLmZpbHRlcigoaXRlbSkgPT5cbiAgICAgICAgcmVnZXhwLnRlc3QoZ2V0QnlQYXRoKGl0ZW0sIHRoaXMucHJvcHMuc2VhcmNoQnkpIHx8IGdldEJ5UGF0aChpdGVtLCB0aGlzLnByb3BzLnZhbHVlRmllbGQpKVxuICAgICAgKTtcbiAgfTtcblxuICBzZWFyY2hSZXN1bHRzID0gKCkgPT4ge1xuICAgIGNvbnN0IGFyZ3MgPSB7IHN0YXRlOiB0aGlzLnN0YXRlLCBwcm9wczogdGhpcy5wcm9wcywgbWV0aG9kczogdGhpcy5tZXRob2RzIH07XG5cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5zZWFyY2hGbihhcmdzKSB8fCB0aGlzLnNlYXJjaEZuKGFyZ3MpO1xuICB9O1xuXG4gIGFjdGl2ZUN1cnNvckl0ZW0gPSAoYWN0aXZlQ3Vyc29ySXRlbSkgPT5cbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGFjdGl2ZUN1cnNvckl0ZW1cbiAgICB9KTtcblxuICBoYW5kbGVLZXlEb3duID0gKGV2ZW50KSA9PiB7XG4gICAgY29uc3QgYXJncyA9IHsgZXZlbnQsIHN0YXRlOiB0aGlzLnN0YXRlLCBwcm9wczogdGhpcy5wcm9wcywgbWV0aG9kczogdGhpcy5tZXRob2RzLCBzZXRTdGF0ZTogdGhpcy5zZXRTdGF0ZS5iaW5kKHRoaXMpIH07XG5cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5oYW5kbGVLZXlEb3duRm4oYXJncykgfHwgdGhpcy5oYW5kbGVLZXlEb3duRm4oYXJncyk7XG4gIH07XG5cbiAgaGFuZGxlS2V5RG93bkZuID0gKHsgZXZlbnQsIHN0YXRlLCBwcm9wcywgbWV0aG9kcywgc2V0U3RhdGUgfSkgPT4ge1xuICAgIGNvbnN0IHsgY3Vyc29yIH0gPSBzdGF0ZTtcblxuICAgIGlmIChldmVudC5rZXkgPT09ICdBcnJvd0Rvd24nICYmIGN1cnNvciA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHNldFN0YXRlKHtcbiAgICAgICAgY3Vyc29yOiAwXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQua2V5ID09PSAnQXJyb3dVcCcgfHwgZXZlbnQua2V5ID09PSAnQXJyb3dEb3duJykge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgdGhpcy5kcm9wRG93bignY2xvc2UnKTtcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICBjb25zdCBjdXJyZW50SXRlbSA9IG1ldGhvZHMuc2VhcmNoUmVzdWx0cygpW2N1cnNvcl07XG4gICAgICBpZiAoY3VycmVudEl0ZW0gJiYgIWN1cnJlbnRJdGVtLmRpc2FibGVkKSB7XG4gICAgICAgIGlmIChwcm9wcy5jcmVhdGUgJiYgdmFsdWVFeGlzdEluU2VsZWN0ZWQoc3RhdGUuc2VhcmNoLCBzdGF0ZS52YWx1ZXMsIHByb3BzKSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgbWV0aG9kcy5hZGRJdGVtKGN1cnJlbnRJdGVtKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZXZlbnQua2V5ID09PSAnQXJyb3dVcCcgJiYgY3Vyc29yID4gMCkge1xuICAgICAgc2V0U3RhdGUoKHByZXZTdGF0ZSkgPT4gKHtcbiAgICAgICAgY3Vyc29yOiBwcmV2U3RhdGUuY3Vyc29yIC0gMVxuICAgICAgfSkpO1xuICAgIH1cblxuICAgIGlmIChldmVudC5rZXkgPT09ICdBcnJvd1VwJyAmJiBjdXJzb3IgPT09IDApIHtcbiAgICAgIHNldFN0YXRlKHtcbiAgICAgICAgY3Vyc29yOiBtZXRob2RzLnNlYXJjaFJlc3VsdHMoKS5sZW5ndGhcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChldmVudC5rZXkgPT09ICdBcnJvd0Rvd24nKSB7XG4gICAgICBzZXRTdGF0ZSgocHJldlN0YXRlKSA9PiAoe1xuICAgICAgICBjdXJzb3I6IHByZXZTdGF0ZS5jdXJzb3IgKyAxXG4gICAgICB9KSk7XG4gICAgfVxuXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gJ0Fycm93RG93bicgJiYgbWV0aG9kcy5zZWFyY2hSZXN1bHRzKCkubGVuZ3RoID09PSBjdXJzb3IpIHtcbiAgICAgIHJldHVybiBzZXRTdGF0ZSh7XG4gICAgICAgIGN1cnNvcjogMFxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJlbmRlckRyb3Bkb3duID0gKCkgPT5cbiAgICB0aGlzLnByb3BzLnBvcnRhbCA/IChcbiAgICAgIFJlYWN0RE9NLmNyZWF0ZVBvcnRhbChcbiAgICAgICAgPERyb3Bkb3duIHByb3BzPXt0aGlzLnByb3BzfSBzdGF0ZT17dGhpcy5zdGF0ZX0gbWV0aG9kcz17dGhpcy5tZXRob2RzfSAvPixcbiAgICAgICAgdGhpcy5kcm9wZG93blJvb3RcbiAgICAgIClcbiAgICApIDogKFxuICAgICAgPERyb3Bkb3duIHByb3BzPXt0aGlzLnByb3BzfSBzdGF0ZT17dGhpcy5zdGF0ZX0gbWV0aG9kcz17dGhpcy5tZXRob2RzfSAvPlxuICAgICk7XG5cbiAgY3JlYXRlTmV3ID0gKGl0ZW0pID0+IHtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IHtcbiAgICAgIFt0aGlzLnByb3BzLmxhYmVsRmllbGRdOiBpdGVtLFxuICAgICAgW3RoaXMucHJvcHMudmFsdWVGaWVsZF06IGl0ZW1cbiAgICB9O1xuXG4gICAgdGhpcy5hZGRJdGVtKG5ld1ZhbHVlKTtcbiAgICB0aGlzLnByb3BzLm9uQ3JlYXRlTmV3KG5ld1ZhbHVlKTtcbiAgICB0aGlzLnNldFN0YXRlKHsgc2VhcmNoOiAnJyB9KTtcbiAgfTtcblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxDbGlja091dHNpZGUgb25DbGlja091dHNpZGU9eyhldmVudCkgPT4gdGhpcy5kcm9wRG93bignY2xvc2UnLCBldmVudCl9PlxuICAgICAgICA8UmVhY3REcm9wZG93blNlbGVjdFxuICAgICAgICAgIG9uS2V5RG93bj17dGhpcy5oYW5kbGVLZXlEb3dufVxuICAgICAgICAgIG9uQ2xpY2s9eyhldmVudCkgPT4gdGhpcy5kcm9wRG93bignb3BlbicsIGV2ZW50KX1cbiAgICAgICAgICB0YWJJbmRleD1cIjBcIlxuICAgICAgICAgIGRpcmVjdGlvbj17dGhpcy5wcm9wcy5kaXJlY3Rpb259XG4gICAgICAgICAgc3R5bGU9e3RoaXMucHJvcHMuc3R5bGV9XG4gICAgICAgICAgcmVmPXt0aGlzLnNlbGVjdH1cbiAgICAgICAgICBkaXNhYmxlZD17dGhpcy5wcm9wcy5kaXNhYmxlZH1cbiAgICAgICAgICBjbGFzc05hbWU9e2Ake0xJQl9OQU1FfSAke3RoaXMucHJvcHMuY2xhc3NOYW1lfWB9XG4gICAgICAgICAgY29sb3I9e3RoaXMucHJvcHMuY29sb3J9PlxuICAgICAgICAgIDxDb250ZW50IHByb3BzPXt0aGlzLnByb3BzfSBzdGF0ZT17dGhpcy5zdGF0ZX0gbWV0aG9kcz17dGhpcy5tZXRob2RzfSAvPlxuXG4gICAgICAgICAge3RoaXMucHJvcHMubmFtZSAmJiAoXG4gICAgICAgICAgICA8aW5wdXQgbmFtZT17dGhpcy5wcm9wcy5uYW1lfSB0eXBlPVwiaGlkZGVuXCIgdmFsdWU9e3RoaXMucHJvcHMudmFsdWVzfSAvPlxuICAgICAgICAgICl9XG5cbiAgICAgICAgICB7dGhpcy5wcm9wcy5sb2FkaW5nICYmIDxMb2FkaW5nIHByb3BzPXt0aGlzLnByb3BzfSAvPn1cblxuICAgICAgICAgIHt0aGlzLnByb3BzLmNsZWFyYWJsZSAmJiAoXG4gICAgICAgICAgICA8Q2xlYXIgcHJvcHM9e3RoaXMucHJvcHN9IHN0YXRlPXt0aGlzLnN0YXRlfSBtZXRob2RzPXt0aGlzLm1ldGhvZHN9IC8+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHt0aGlzLnByb3BzLnNlcGFyYXRvciAmJiAoXG4gICAgICAgICAgICA8U2VwYXJhdG9yIHByb3BzPXt0aGlzLnByb3BzfSBzdGF0ZT17dGhpcy5zdGF0ZX0gbWV0aG9kcz17dGhpcy5tZXRob2RzfSAvPlxuICAgICAgICAgICl9XG5cbiAgICAgICAgICB7dGhpcy5wcm9wcy5kcm9wZG93bkhhbmRsZSAmJiAoXG4gICAgICAgICAgICA8RHJvcGRvd25IYW5kbGVcbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gdGhpcy5zZWxlY3QuY3VycmVudC5mb2N1cygpfVxuICAgICAgICAgICAgICBwcm9wcz17dGhpcy5wcm9wc31cbiAgICAgICAgICAgICAgc3RhdGU9e3RoaXMuc3RhdGV9XG4gICAgICAgICAgICAgIG1ldGhvZHM9e3RoaXMubWV0aG9kc31cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKX1cblxuICAgICAgICAgIHt0aGlzLnN0YXRlLmRyb3Bkb3duICYmIHRoaXMucmVuZGVyRHJvcGRvd24oKX1cbiAgICAgICAgPC9SZWFjdERyb3Bkb3duU2VsZWN0PlxuICAgICAgPC9DbGlja091dHNpZGU+XG4gICAgKTtcbiAgfVxufVxuXG5TZWxlY3QuZGVmYXVsdFByb3BzID0ge1xuICBhZGRQbGFjZWhvbGRlcjogJycsXG4gIHBsYWNlaG9sZGVyOiAnU2VsZWN0Li4uJyxcbiAgdmFsdWVzOiBbXSxcbiAgb3B0aW9uczogW10sXG4gIG11bHRpOiBmYWxzZSxcbiAgZGlzYWJsZWQ6IGZhbHNlLFxuICBzZWFyY2hCeTogJ2xhYmVsJyxcbiAgc29ydEJ5OiBudWxsLFxuICBjbGVhcmFibGU6IGZhbHNlLFxuICBzZWFyY2hhYmxlOiB0cnVlLFxuICBkcm9wZG93bkhhbmRsZTogdHJ1ZSxcbiAgc2VwYXJhdG9yOiBmYWxzZSxcbiAga2VlcE9wZW46IHVuZGVmaW5lZCxcbiAgbm9EYXRhTGFiZWw6ICdObyBkYXRhJyxcbiAgY3JlYXRlTmV3TGFiZWw6ICdhZGQge3NlYXJjaH0nLFxuICBkaXNhYmxlZExhYmVsOiAnZGlzYWJsZWQnLFxuICBkcm9wZG93bkdhcDogNSxcbiAgY2xvc2VPblNjcm9sbDogZmFsc2UsXG4gIGRlYm91bmNlRGVsYXk6IDAsXG4gIGxhYmVsRmllbGQ6ICdsYWJlbCcsXG4gIHZhbHVlRmllbGQ6ICd2YWx1ZScsXG4gIGNvbG9yOiAnIzAwNzREOScsXG4gIGtlZXBTZWxlY3RlZEluTGlzdDogdHJ1ZSxcbiAgY2xvc2VPblNlbGVjdDogZmFsc2UsXG4gIGNsZWFyT25CbHVyOiB0cnVlLFxuICBjbGVhck9uU2VsZWN0OiB0cnVlLFxuICBkcm9wZG93blBvc2l0aW9uOiAnYm90dG9tJyxcbiAgZHJvcGRvd25IZWlnaHQ6ICczMDBweCcsXG4gIGF1dG9Gb2N1czogZmFsc2UsXG4gIHBvcnRhbDogbnVsbCxcbiAgY3JlYXRlOiBmYWxzZSxcbiAgZGlyZWN0aW9uOiAnbHRyJyxcbiAgbmFtZTogbnVsbCxcbiAgb25DaGFuZ2U6ICgpID0+IHVuZGVmaW5lZCxcbiAgb25Ecm9wZG93bk9wZW46ICgpID0+IHVuZGVmaW5lZCxcbiAgb25Ecm9wZG93bkNsb3NlOiAoKSA9PiB1bmRlZmluZWQsXG4gIG9uQ2xlYXJBbGw6ICgpID0+IHVuZGVmaW5lZCxcbiAgb25TZWxlY3RBbGw6ICgpID0+IHVuZGVmaW5lZCxcbiAgb25DcmVhdGVOZXc6ICgpID0+IHVuZGVmaW5lZCxcbiAgc2VhcmNoRm46ICgpID0+IHVuZGVmaW5lZCxcbiAgaGFuZGxlS2V5RG93bkZuOiAoKSA9PiB1bmRlZmluZWQsXG59O1xuXG5jb25zdCBSZWFjdERyb3Bkb3duU2VsZWN0ID0gc3R5bGVkLmRpdmBcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xuICB3aWR0aDogMTAwJTtcbiAgYm9yZGVyLXJhZGl1czogMnB4O1xuICBwYWRkaW5nOiAycHggNXB4O1xuICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICBkaXJlY3Rpb246ICR7KHsgZGlyZWN0aW9uIH0pID0+IGRpcmVjdGlvbn07XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIG1pbi1oZWlnaHQ6IDM2cHg7XG4gICR7KHsgZGlzYWJsZWQgfSkgPT5cbiAgICBkaXNhYmxlZCA/ICdjdXJzb3I6IG5vdC1hbGxvd2VkO3BvaW50ZXItZXZlbnRzOiBub25lO29wYWNpdHk6IDAuMzsnIDogJ3BvaW50ZXItZXZlbnRzOiBhbGw7J31cblxuICA6aG92ZXIsXG4gIDpmb2N1cy13aXRoaW4ge1xuICAgIGJvcmRlci1jb2xvcjogJHsoeyBjb2xvciB9KSA9PiBjb2xvcn07XG4gIH1cblxuICA6Zm9jdXMsXG4gIDpmb2N1cy13aXRoaW4ge1xuICAgIG91dGxpbmU6IDA7XG4gICAgYm94LXNoYWRvdzogMCAwIDAgM3B4ICR7KHsgY29sb3IgfSkgPT4gaGV4VG9SR0JBKGNvbG9yLCAwLjIpfTtcbiAgfVxuYDtcblxuZXhwb3J0IGRlZmF1bHQgU2VsZWN0O1xuIl19 */\")),\n    _default = Select;\nexports.default = _default;","map":null,"metadata":{},"sourceType":"script"}